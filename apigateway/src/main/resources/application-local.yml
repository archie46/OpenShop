# Local Development Profile for API Gateway
# This profile uses localhost addresses instead of Kubernetes service names

spring:
  cloud:
    gateway:
      server:
        webflux:
          routes:
            # ---------------------------
            # User Service (Public Routes)
            # ---------------------------
            - id: user-service
              uri: http://localhost:8081
              predicates:
                - Path=/api/auth/**
              filters:
                - AddRequestHeader=X-Gateway, SpringCloudGateway

            # ---------------------------
            # Protected User Routes
            # ---------------------------
            - id: user-service-protected
              uri: http://localhost:8081
              predicates:
                - Path=/api/users/**
              filters:
                - name: JwtRequestFilter

            # ---------------------------
            # Product Service - GraphQL (External Access Only)
            # ---------------------------
            - id: product-service-graphql
              uri: http://localhost:8082
              predicates:
                - Path=/graphql/products
              filters:
                - JwtRequestFilter
                - RewritePath=/graphql/products, /graphql

            # ---------------------------
            # Product Service - GraphiQL (Development/Testing)
            # ---------------------------
            - id: product-service-graphiql
              uri: http://localhost:8082
              predicates:
                - Path=/graphiql/products
              filters:
                - RewritePath=/graphiql/products, /graphiql

            # ---------------------------
            # Order Service
            # ---------------------------
            - id: order-service
              uri: http://localhost:8083
              predicates:
                - Path=/api/orders/**,/api/orders
              filters:
                - JwtRequestFilter

            # ---------------------------
            # Inventory Service
            # ---------------------------
            - id: inventory-service
              uri: http://localhost:8086
              predicates:
                - Path=/api/inventory/**,/api/inventory
              filters:
                - JwtRequestFilter

            # ---------------------------
            # Cart Service
            # ---------------------------
            - id: cart-service
              uri: http://localhost:8085
              predicates:
                - Path=/api/cart/**
              filters:
                - JwtRequestFilter

            # ---------------------------
            # Payment Service
            # ---------------------------
            - id: payment-service
              uri: http://localhost:8084
              predicates:
                - Path=/api/payments/**
              filters:
                - JwtRequestFilter

            # ---------------------------
            # Shipping Service
            # ---------------------------
            - id: shipping-service
              uri: http://localhost:8088
              predicates:
                - Path=/api/shipping/**
              filters:
                - JwtRequestFilter

            # ---------------------------
            # Notification Service
            # ---------------------------
jwt:
  secret: q09hQkwBA5H1SKELTBwDSaKYsr5Jaep4d8PBXTjSGGk=
